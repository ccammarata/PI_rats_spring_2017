Ch3in <- which(data1$marker=="4")
H2O2in <- which(data1$marker=="5")
H2O2done <- which(data1$marker=="6")
current <-c(data1[Ch1in,electrodeColNum] , data1[Ch2in,electrodeColNum] , data1[Ch3in,electrodeColNum] , data1[H2O2in,electrodeColNum])
choline <- c(0 , 20 , 40 , 60)
fit <- lm(current~choline)
plot(current~choline)
mySlope <- fit$coefficients[[2]]
return(mySlope) }
setwd("E:/")
library(reshape2)
library(psych)
hrv_data <- read.csv("HRV_PI.csv")
library(reshape2)
library(psych)
hrv_data <- read.csv("HRV_PI.csv")
hr_by_rat <- dcast(hrv_data, rat~session,value.var="avg_HR")
hr_by_rat <- data.frame(hr_by_rat)
rmssd_by_rat <- dcast(hrv_data, rat~session,value.var="rmssd")
rmssd_by_rat <- data.frame(rmssd_by_rat)
describe(hr_by_rat)
describe(rmssd_by_rat)
plot(X1~X2,data=rmssd_by_rat)
plot(X1~X2,data=hr_by_rat)
lm1 <- lm(X1~X2,data=rmssd_by_rat)
lm1
summary(lm1)
lm2 <- lm(X1~X2,data=hr_by_rat)
summary(lm2)
colnames(hr_by_rat)<- c("day_1","day_2")
colnames(rmssd_by_rat)<-c("day_1","day_2")
plot(X1~X2,data=rmssd_by_rat, main="heart rate, day 1 vs. day 2")
plot(day_1~day_2,data=rmssd_by_rat, main="heart rate, day 1 vs. day 2")
plot(day_1~day_2,data=rmssd_by_rat, main="RMSSD, day 1 vs. day 2", xlab="RMSSD day 2",ylab="RMSSD day 1")
plot(day_1~day_2,data=hr_by_rat, main="heart rate for each rat, day 1 vs. day 2", xlab="HR day 2",ylab="HR day 1")
plot(day_1~day_2,data=rmssd_by_rat, main="RMSSD for each rat, day 1 vs. day 2", xlab="RMSSD day 2",ylab="RMSSD day 1")
abline(lm(day_1~day_2,data=rmssd_by_rat))
plot(day_1~day_2,data=rmssd_by_rat, main="RMSSD for each rat, day 1 vs. day 2", xlab="RMSSD day 2",ylab="RMSSD day 1")
abline(lm(day_1~day_2,data=rmssd_by_rat))
plot(day_1~day_2,data=rmssd_by_rat, main="RMSSD for each rat, day 1 vs. day 2", xlab="RMSSD day 2",ylab="RMSSD day 1")
abline(lm(day_1~day_2,data=rmssd_by_rat))
plot(day_1~day_2,data=hr_by_rat, main="heart rate for each rat, day 1 vs. day 2", xlab="HR day 2",ylab="HR day 1")
abline(lm(day_1~day_2,data=hr_by_rat))
plot(day_1~day_2,data=rmssd_by_rat, main="RMSSD for each rat, day 1 vs. day 2", xlab="RMSSD day 2",ylab="RMSSD day 1")
plot(day_1~day_2,data=hr_by_rat, main="heart rate for each rat, day 1 vs. day 2", xlab="HR day 2",ylab="HR day 1")
plot(day_2~day_2,data=hr_by_rat, main="heart rate for each rat, day 1 vs. day 2", xlab="HR day 2",ylab="HR day 1")
plot(day_2~day_1,data=hr_by_rat, main="heart rate for each rat, day 1 vs. day 2", xlab="HR day 2",ylab="HR day 1")
abline(lm(day_2~day_1,data=hr_by_rat))
library(reshape2)
library(psych)
hrv_data <- read.csv("HRV_PI.csv")
hr_by_rat <- dcast(hrv_data, rat~session,value.var="avg_HR")
hr_by_rat <- data.frame(hr_by_rat)
colnames(hr_by_rat)<- c("day_1","day_2")
rmssd_by_rat <- dcast(hrv_data, rat~session,value.var="rmssd")
rmssd_by_rat <- data.frame(rmssd_by_rat)
colnames(rmssd_by_rat)<-c("day_1","day_2")
plot(day_1~day_2,data=rmssd_by_rat, main="RMSSD for each rat, day 1 vs. day 2", xlab="RMSSD day 2",ylab="RMSSD day 1")
abline(lm(day_1~day_2,data=rmssd_by_rat))
plot(day_1~day_2,data=hr_by_rat, main="heart rate for each rat, day 1 vs. day 2", xlab="HR day 2",ylab="HR day 1")
abline(lm(day_1~day_2,data=hr_by_rat))
lm1 <- lm(day_1~day_2,data=rmssd_by_rat)
summary(lm1)
lm2 <- lm(day_1~day_2,data=hr_by_rat)
summary(lm2)
View(hr_by_rat)
hrv_data <- read.csv("HRV_PI.csv")
hr_by_rat <- dcast(hrv_data, rat~session,value.var="avg_HR")
hr_by_rat <- data.frame(hr_by_rat)
colnames(hr_by_rat)<- c("ratID","day_1","day_2")
rmssd_by_rat <- dcast(hrv_data, rat~session,value.var="rmssd")
rmssd_by_rat <- data.frame(rmssd_by_rat)
colnames(rmssd_by_rat)<-c("ratID","day_1","day_2")
plot(day_1~day_2,data=rmssd_by_rat, main="RMSSD for each rat, day 1 vs. day 2", xlab="RMSSD day 2",ylab="RMSSD day 1")
abline(lm(day_1~day_2,data=rmssd_by_rat))
plot(day_1~day_2,data=hr_by_rat, main="heart rate for each rat, day 1 vs. day 2", xlab="HR day 2",ylab="HR day 1")
abline(lm(day_1~day_2,data=hr_by_rat))
library(kable)
install.packages("pander")
library(kpander)
library(pander)
pander(lm1)
pander(lm2)
lm1$coefficients
lm1
summary(lm1)
lm1[1]
lm1[12]
lm1[[12]]
lm1$r.suared
lm1$r.squared
summary(lm1)$r.squared
R squared: ```{r,echo=FALSE}summary(lm1)$r.squared```
pander(describe(hr_by_rat))
options(contrasts=c("contr.sum", "contr.poly"))
library(foreign)
library(psych)
library(reshape2)
library(ggplot2)
library(car)
library(ez)
library(Rmisc)
library(gmodels)
library(package)
library(afex)
library(pander)
# for AB acquisition
sessList <- list(136,137,138,139)#list session nubmers here
ratList <- list(101,102,103,104,105,106,107,108,109,110,112)#list rat number here
x <- length(sessList)
y <- length(ratList)
rowsNeeded <- (x*y)
ABsummary <- matrix(data = NA, nrow = rowsNeeded, ncol=3)
colnames(ABsummary)<- c('ratID', 'session', 'accuracy')
i = 1
for (sessNum in sessList){
for (rat in ratList) {
filename <- paste("U3_",rat,"_",sessNum,".csv", sep="")
print(filename)
currentData <- read.csv(filename, header=TRUE, sep="\t")
currentData$resp2 <- ifelse(currentData$Response == "correct", 1,0)
currentAB <- subset(currentData, trialType == "AB")
ABacc <- mean(currentAB$resp2)
ABsummary[i,0:3] <- c(rat, sessNum, ABacc)
i=i+1
}
}
ABsummary <- data.frame(ABsummary)
ABsummary$ratID <- as.factor(ABsummary$ratID)
ABsummary$session <- as.factor(ABsummary$session)
ABsummaryTable <- aggregate(accuracy~session, data=ABsummary, FUN=(mean))
tempTable <- aggregate(accuracy~session, data=ABsummary, FUN=(sd))
ABsummaryTable<- as.data.frame(ABsummaryTable)
ABsummaryTable$sd <- tempTable$accuracy*100
tempTable$accuracy <- tempTable$accuracy/sqrt(y)
ABsummaryTable$se <- tempTable$accuracy*100
ABsummaryTable$accuracy <- ABsummaryTable$accuracy * 100
#for full task
sessList <- list(140,141,142,143,144)#list session nubmers here
ratList <- list(101,102,103,104,105,106,107,108,109,110,112)#list rat number here
x <- length(sessList)
y <- length(ratList)
rowsNeeded <- (x*y)
FULLsummary <- matrix(data = NA, nrow = rowsNeeded, ncol=5)
colnames(FULLsummary)<- c('ratID', 'session', 'AB_acc', 'AC_acc', 'DE_acc')
i = 1
for (sessNum in sessList){
for (rat in ratList) {
filename <- paste("U3_",rat,"_",sessNum,".csv", sep="")
print(filename)
currentData <- read.csv(filename, header=TRUE, sep="\t")
currentData$resp2 <- ifelse(currentData$Response == "correct", 1,0)
currentAB <- subset(currentData, trialType == "AB")
ABacc <- mean(currentAB$resp2)
currentDE <- subset(currentData, trialType == "DE")
DEacc <- mean(currentDE$resp2)
currentAC <- subset(currentData, trialType == "CA")
ACacc <- mean(currentAC$resp2)
FULLsummary[i,0:5] <- c(rat, sessNum, ABacc, ACacc, DEacc)
i=i+1
}
}
#prepare wide and long form data frames for full task
FULLfinalSummaryW <- data.frame(FULLsummary)
#FULLfinalSummaryW$PI_effect <- FULLfinalSummaryW$DE_acc - FULLfinalSummaryW$AC_acc
z = rowsNeeded*3
FULLfinalSummaryL <- reshape(FULLfinalSummaryW, varying = c('AB_acc', 'AC_acc', 'DE_acc'), v.names="accuracy",
timevar='trialType',times=c('AB', 'CA', 'DE'), new.row.names=1:z, direction = 'long')
FULLfinalSummaryL$ratID <-as.factor(FULLfinalSummaryL$ratID)
FULLfinalSummaryL$session <-as.factor(FULLfinalSummaryL$session)
FULLfinalSummaryL$trialType <- as.factor(FULLfinalSummaryL$trialType)
FULLfinalSummaryW$ratID <-as.factor(FULLfinalSummaryW$ratID)
FULLfinalSummaryW$session <-as.factor(FULLfinalSummaryW$session)
#making summary table for full task
FULLsummaryTable <- aggregate(accuracy~trialType, data=FULLfinalSummaryL, FUN=(mean))
tempTable <- aggregate(accuracy~trialType, data=FULLfinalSummaryL, FUN=(sd))
FULLsummaryTable<- as.data.frame(FULLsummaryTable)
FULLsummaryTable$sd <- tempTable$accuracy
tempTable$accuracy <- tempTable$accuracy/sqrt(y)
FULLsummaryTable$se <- tempTable$accuracy
FULLsummaryTable$accuracy <- FULLsummaryTable$accuracy
setwd("E:/")
setwd("E:/")
setwd("~/GitHub/PI_rats_spring_2017/PI_spring_summer_2017/summer_hrv_experiment_data")
# for AB acquisition
sessList <- list(136,137,138,139)#list session nubmers here
ratList <- list(101,102,103,104,105,106,107,108,109,110,112)#list rat number here
x <- length(sessList)
y <- length(ratList)
rowsNeeded <- (x*y)
ABsummary <- matrix(data = NA, nrow = rowsNeeded, ncol=3)
colnames(ABsummary)<- c('ratID', 'session', 'accuracy')
i = 1
for (sessNum in sessList){
for (rat in ratList) {
filename <- paste("U3_",rat,"_",sessNum,".csv", sep="")
print(filename)
currentData <- read.csv(filename, header=TRUE, sep="\t")
currentData$resp2 <- ifelse(currentData$Response == "correct", 1,0)
currentAB <- subset(currentData, trialType == "AB")
ABacc <- mean(currentAB$resp2)
ABsummary[i,0:3] <- c(rat, sessNum, ABacc)
i=i+1
}
}
ABsummary <- data.frame(ABsummary)
ABsummary$ratID <- as.factor(ABsummary$ratID)
ABsummary$session <- as.factor(ABsummary$session)
ABsummaryTable <- aggregate(accuracy~session, data=ABsummary, FUN=(mean))
tempTable <- aggregate(accuracy~session, data=ABsummary, FUN=(sd))
ABsummaryTable<- as.data.frame(ABsummaryTable)
ABsummaryTable$sd <- tempTable$accuracy*100
tempTable$accuracy <- tempTable$accuracy/sqrt(y)
ABsummaryTable$se <- tempTable$accuracy*100
ABsummaryTable$accuracy <- ABsummaryTable$accuracy * 100
#for full task
sessList <- list(140,141,142,143,144)#list session nubmers here
ratList <- list(101,102,103,104,105,106,107,108,109,110,112)#list rat number here
x <- length(sessList)
y <- length(ratList)
rowsNeeded <- (x*y)
FULLsummary <- matrix(data = NA, nrow = rowsNeeded, ncol=5)
colnames(FULLsummary)<- c('ratID', 'session', 'AB_acc', 'AC_acc', 'DE_acc')
i = 1
for (sessNum in sessList){
for (rat in ratList) {
filename <- paste("U3_",rat,"_",sessNum,".csv", sep="")
print(filename)
currentData <- read.csv(filename, header=TRUE, sep="\t")
currentData$resp2 <- ifelse(currentData$Response == "correct", 1,0)
currentAB <- subset(currentData, trialType == "AB")
ABacc <- mean(currentAB$resp2)
currentDE <- subset(currentData, trialType == "DE")
DEacc <- mean(currentDE$resp2)
currentAC <- subset(currentData, trialType == "CA")
ACacc <- mean(currentAC$resp2)
FULLsummary[i,0:5] <- c(rat, sessNum, ABacc, ACacc, DEacc)
i=i+1
}
}
#prepare wide and long form data frames for full task
FULLfinalSummaryW <- data.frame(FULLsummary)
#FULLfinalSummaryW$PI_effect <- FULLfinalSummaryW$DE_acc - FULLfinalSummaryW$AC_acc
z = rowsNeeded*3
FULLfinalSummaryL <- reshape(FULLfinalSummaryW, varying = c('AB_acc', 'AC_acc', 'DE_acc'), v.names="accuracy",
timevar='trialType',times=c('AB', 'CA', 'DE'), new.row.names=1:z, direction = 'long')
FULLfinalSummaryL$ratID <-as.factor(FULLfinalSummaryL$ratID)
FULLfinalSummaryL$session <-as.factor(FULLfinalSummaryL$session)
FULLfinalSummaryL$trialType <- as.factor(FULLfinalSummaryL$trialType)
FULLfinalSummaryW$ratID <-as.factor(FULLfinalSummaryW$ratID)
FULLfinalSummaryW$session <-as.factor(FULLfinalSummaryW$session)
#making summary table for full task
FULLsummaryTable <- aggregate(accuracy~trialType, data=FULLfinalSummaryL, FUN=(mean))
tempTable <- aggregate(accuracy~trialType, data=FULLfinalSummaryL, FUN=(sd))
FULLsummaryTable<- as.data.frame(FULLsummaryTable)
FULLsummaryTable$sd <- tempTable$accuracy
tempTable$accuracy <- tempTable$accuracy/sqrt(y)
FULLsummaryTable$se <- tempTable$accuracy
FULLsummaryTable$accuracy <- FULLsummaryTable$accuracy
describe(ABsummary)
hist(ABsummary$accuracy,main = ('Distribution of Accuracy during AB acquisiton, all sessions'),xlab = ('AB accuracy'))
#distribution is actually a bit strange, though all above chance - also pretty small number of rats
plot(accuracy~session, data=ABsummary, main=('AB accuracy by session, AB acquisition'))
pander(describe(ABsummary))
describe(FULLfinalSummaryW)
describe(FULLfinalSummaryL)
p1= ggplot(data=FULLfinalSummaryL, aes(trialType,accuracy))
p1+geom_boxplot(aes(fill=trialType)) +
coord_cartesian(ylim=c(0,1))+
ggtitle("Accuracy by Trial type, averages across full task days") +
labs(x="Trial Type",y="Accuracy")+
scale_fill_manual(values=wes_palette("Cavalcanti"))+
guides(fill=guide_legend(title="trial type"))
library(wesanderson)
library(wesanderson)
p1= ggplot(data=FULLfinalSummaryL, aes(trialType,accuracy))
p1+geom_boxplot(aes(fill=trialType)) +
coord_cartesian(ylim=c(0,1))+
ggtitle("Accuracy by Trial type, averages across full task days") +
labs(x="Trial Type",y="Accuracy")+
scale_fill_manual(values=wes_palette("Cavalcanti"))+
guides(fill=guide_legend(title="trial type"))
p1+geom_boxplot(aes(fill=trialType)) +
coord_cartesian(ylim=c(0,1))+
ggtitle("Accuracy by Trial type, averages across full task days") +
labs(x="Trial Type",y="Accuracy")+
scale_fill_manual(values=wes_palette("FantasticFox"))+
guides(fill=guide_legend(title="trial type"))
FULLsummaryTable <- aggregate(accuracy~trialType+session, data=FULLfinalSummaryL, FUN=(mean))
tempTable <- aggregate(accuracy~trialType+session, data=FULLfinalSummaryL, FUN=(sd))
FULLsummaryTable<- as.data.frame(FULLsummaryTable)
FULLsummaryTable$sd <- tempTable$accuracy
tempTable$accuracy <- tempTable$accuracy/sqrt(y)
FULLsummaryTable$se <- tempTable$accuracy
FULLsummaryTable$accuracy <- FULLsummaryTable$accuracy
subSummaryTable <-subset(FULLsummaryTable, trialType != 'AB')
ggplot(subSummaryTable, aes(x=session,y=accuracy,colour = trialType))+
geom_line(aes(group=trialType))+geom_point()+
geom_errorbar(aes(ymin=accuracy-se, ymax=accuracy+se),width=.05)+
ggtitle('Accuracy by Trial Type and Session, Full Task Days')
plot(PI_effect~session,data=FULLfinalSummaryW, main=('PI effect (DE - CA) by session'),ylab = ('PI Effect'))
aov2 <- aov_ez("ratID","accuracy",data=FULLfinalSummaryL,within = c("trialType","session"))
pander(summary(aov2))
AB_wide <- dcast(ABsummary, ratID~session, value.var = "accuracy")
AB_wide$last_two_days <- (AB_wide$`138`+ AB_wide$`139`)/2
keepRats <- subset(AB_wide, last_two_days >=.70)
keepRats <- array(keepRats$ratID)
keepRats <- array(keepRats$ratID)
data2 <- subset(FULLfinalSummaryW, ratID %in% keepRats)
data3 <- subset(FULLfinalSummaryL, ratID %in% keepRats)
data3Table <- aggregate(accuracy~trialType+session, data=data3, FUN=(mean))
tempTable <- aggregate(accuracy~trialType+session, data=data3, FUN=(sd))
data3Table<- as.data.frame(data3Table)
data3Table$sd <- tempTable$accuracy
tempTable$accuracy <- tempTable$accuracy/sqrt(y)
data3Table$se <- tempTable$accuracy
data3Table$accuracy <- data3Table$accuracy
ggplot(data3Table, aes(x=session,y=accuracy,colour = trialType))+
geom_line(aes(group=trialType))+
geom_point()+geom_errorbar(aes(ymin=accuracy-se, ymax=accuracy+se),width=.1,position=position_dodge(.05))+
coord_cartesian(ylim=c(.4,1))+
guides(colour=guide_legend(title="trial type"))+
scale_color_manual(values=wes_palette("FantasticFox"))+
ggtitle("High performers' Accuracy by Trial Type and Session, Full Task Days")
sess140 <- subset(FULLfinalSummaryL, session == "140")
aov4 <- aov_ez("ratID","accuracy",data=sess140,within=c("trialType"))
pander(aov4)
pander(summary(aov4))
lsmeans(aov4, "trialType", contr = "pairwise", adjust = "holm")
pander(lsmeans(aov4, "trialType", contr = "pairwise", adjust = "holm"))
pander(summary(lsmeans(aov4, "trialType", contr = "pairwise", adjust = "holm")))
View(hrv_data)
View(hr_by_rat)
View(FULLfinalSummaryW)
aggregate(FULLfinalSummaryW, by=list(ratID), FUN='mean')
aggregate(FULLfinalSummaryW, by=ratID, FUN='mean')
aggregate(FULLfinalSummaryW, by=FULLfinalSummaryW$ratID, FUN='mean')
aggregate(FULLfinalSummaryW, FULLfinalSummaryW$ratID, FUN='mean')
aggregate(FULLfinalSummaryW, by=list(FULLfinalSummaryW$ratID), FUN='mean')
warnings()
aggregate(FULLfinalSummaryW, by=list(FULLfinalSummaryW$ratID), FUN='mean')
testing <- aggregate(FULLfinalSummaryW, by=list(FULLfinalSummaryW$ratID), FUN='mean')
View(testing)
?table
testing <- melt(FULLfinalSummaryW, id.vars = ratID)
testing <- melt(FULLfinalSummaryW, id.vars = FULLfinalSummaryW$ratID)
testing <- melt(FULLfinalSummaryW)
View(testing)
test2 <- dcast(testing, ratID~session, value.var = "value")
test2 <- dcast(testing, ratID~session, value.var = "value", fun.aggregate = mean)
View(test2)
test2 <- dcast(testing, ratID~variable, value.var = "value", fun.aggregate = mean)
masterDataFrame <- dcast(testing, ratID~variable, value.var = "value", fun.aggregate = mean)
View(masterDataFrame)
View(hr_by_rat)
View(hrv_data)
masterDataFrame <- as.data.frame(masterDataFrame)
masterDataFrame$HR_day_1 <- hr_by_rat$day_1
masterDataFrame$HR_day_2 <- hr_by_rat$day_2
masterDataFrame$rmssd_day_1 <- rmssd_by_rat$day_1
masterDataFrame$rmssd_day_2 <- rmssd_by_rat$day_2
rat=101
subset2 <- subset(FULLfinalSummaryW, ratID == rat)
View(subset2)
subset <- subset(FULLfinalSummaryW, ratID == rat)
DE_140 <- subset[1,3]
subset[1,3]
DE_141  <- subset[2,3]
subset[2,3]
deltaDE <- DE_141-DE140
deltaDE <- DE_141-DE_140
deltaCA <- CA_141 - CA_140
deltaValue <- matrix(data=NA,nrow=length(keepRats),ncol = 7)
colnames(deltaValue)<-c("ratID","DE_140","DE_141","CA_140","CA_141","deltaDE","deltaCA","delta_diff")
deltaValue <- matrix(data=NA,nrow=length(keepRats),ncol = 8)
colnames(deltaValue)<-c("ratID","DE_140","DE_141","CA_140","CA_141","deltaDE","deltaCA","delta_diff")
deltaValue <- matrix(data=NA,nrow=length(keepRats),ncol = 5)
colnames(deltaValue)<-c("ratID","DE_140","DE_141","CA_140","CA_141")
deltaValue <- matrix(data=NA,nrow=length(keepRats),ncol = 5)
colnames(deltaValue)<-c("ratID","DE_140","DE_141","CA_140","CA_141")
i=1
for(rat in ratList){
subset <- subset(FULLfinalSummaryW, ratID == rat)
DE_140 <- subset[1,5]
DE_141  <- subset[2,5]
CA_140 <- subset[1,4]
CA_141 <- subset[2,4]
deltaValue[i,]<-c(rat,DE_140,DE_141,CA_140,CA_141)
i=i+1
}
deltaValue <- matrix(data=NA,nrow=length(ratList),ncol = 5)
colnames(deltaValue)<-c("ratID","DE_140","DE_141","CA_140","CA_141")
i=1
for(rat in ratList){
subset <- subset(FULLfinalSummaryW, ratID == rat)
DE_140 <- subset[1,5]
DE_141  <- subset[2,5]
CA_140 <- subset[1,4]
CA_141 <- subset[2,4]
deltaValue[i,]<-c(rat,DE_140,DE_141,CA_140,CA_141)
i=i+1
}
deltaValue <- data.frame(deltaValue)
View(data3Table)
View(deltaValue)
masterDataFrame <- merge(masterDataFrame,deltaValue,by="ratID")
masterDataFrame$deltaDE <- masterDataFrame$DE_141 - masterDataFrame$DE_140
masterDataFrame$deltaCA <- masterDataFrame$CA_141 - masterDataFrame$CA_140
masterDataFrame$delta_diff <- masterDataFrame$deltaDE - masterDataFrame$deltaCA
meltedDF <- melt(FULLfinalSummaryW)
masterDataFrame <- dcast(meltedDF, ratID~variable, value.var = "value", fun.aggregate = mean)
masterDataFrame <- as.data.frame(masterDataFrame)
masterDataFrame$HR_day_1 <- hr_by_rat$day_1
masterDataFrame$HR_day_2 <- hr_by_rat$day_2
masterDataFrame$rmssd_day_1 <- rmssd_by_rat$day_1
masterDataFrame$rmssd_day_2 <- rmssd_by_rat$day_2
deltaValue <- matrix(data=NA,nrow=length(ratList),ncol = 5)
colnames(deltaValue)<-c("ratID","DE_140","DE_141","CA_140","CA_141")
i=1
for(rat in ratList){
subset <- subset(FULLfinalSummaryW, ratID == rat)
DE_140 <- subset[1,5]
DE_141  <- subset[2,5]
CA_140 <- subset[1,4]
CA_141 <- subset[2,4]
deltaValue[i,]<-c(rat,DE_140,DE_141,CA_140,CA_141)
i=i+1
}
deltaValue <- data.frame(deltaValue)
masterDataFrame <- merge(deltaValue,masterDataFrame,by="ratID")
meltedDF <- melt(FULLfinalSummaryW)
masterDataFrame <- dcast(meltedDF, ratID~variable, value.var = "value", fun.aggregate = mean)
masterDataFrame <- as.data.frame(masterDataFrame)
masterDataFrame$HR_day_1 <- hr_by_rat$day_1
masterDataFrame$HR_day_2 <- hr_by_rat$day_2
masterDataFrame$rmssd_day_1 <- rmssd_by_rat$day_1
masterDataFrame$rmssd_day_2 <- rmssd_by_rat$day_2
deltaValue <- matrix(data=NA,nrow=length(ratList),ncol = 5)
colnames(deltaValue)<-c("ratID","DE_140","DE_141","CA_140","CA_141")
i=1
for(rat in ratList){
subset <- subset(FULLfinalSummaryW, ratID == rat)
DE_140 <- subset[1,5]
DE_141  <- subset[2,5]
CA_140 <- subset[1,4]
CA_141 <- subset[2,4]
deltaValue[i,]<-c(rat,DE_140,DE_141,CA_140,CA_141)
i=i+1
}
deltaValue <- data.frame(deltaValue)
masterDataFrame <- merge(masterDataFrame,deltaValue,by="ratID")
masterDataFrame$deltaDE <- masterDataFrame$DE_141 - masterDataFrame$DE_140
masterDataFrame$deltaCA <- masterDataFrame$CA_141 - masterDataFrame$CA_140
masterDataFrame$delta_diff <- masterDataFrame$deltaDE - masterDataFrame$deltaCA
masterDataFrame$meanHR <- mean(masterDataFrame$HR_day_1,masterDataFrame$HR_day_2)
View(masterDataFrame)
masterDataFrame$meanHR <- mean(masterDataFrame[5:6])
masterDataFrame$meanHR <- mean(masterDataFrame[,5:6])
masterDataFrame$meanHR <- mean(masterDataFrame[5:7])
masterDataFrame$meanHR <- mean(masterDataFrame[5],masterDataFrame[6])
masterDataFrame[5]
masterDataFrame$meanHR <- rowMeans(masterDataFrame[5:6])
masterDataFrame <- dcast(meltedDF, ratID~variable, value.var = "value", fun.aggregate = mean)
masterDataFrame <- as.data.frame(masterDataFrame)
masterDataFrame$HR_day_1 <- hr_by_rat$day_1
masterDataFrame$HR_day_2 <- hr_by_rat$day_2
masterDataFrame$meanHR <- rowMeans(masterDataFrame[5:6])
masterDataFrame$rmssd_day_1 <- rmssd_by_rat$day_1
masterDataFrame$rmssd_day_2 <- rmssd_by_rat$day_2
masterDataFrame$meanHR <- rowMeans(masterDataFrame[7:8])
deltaValue <- matrix(data=NA,nrow=length(ratList),ncol = 5)
colnames(deltaValue)<-c("ratID","DE_140","DE_141","CA_140","CA_141")
i=1
for(rat in ratList){
subset <- subset(FULLfinalSummaryW, ratID == rat)
DE_140 <- subset[1,5]
DE_141  <- subset[2,5]
CA_140 <- subset[1,4]
CA_141 <- subset[2,4]
deltaValue[i,]<-c(rat,DE_140,DE_141,CA_140,CA_141)
i=i+1
}
deltaValue <- data.frame(deltaValue)
masterDataFrame <- merge(masterDataFrame,deltaValue,by="ratID")
masterDataFrame$deltaDE <- masterDataFrame$DE_141 - masterDataFrame$DE_140
masterDataFrame$deltaCA <- masterDataFrame$CA_141 - masterDataFrame$CA_140
masterDataFrame$delta_diff <- masterDataFrame$deltaDE - masterDataFrame$deltaCA
masterDataFrame <- dcast(meltedDF, ratID~variable, value.var = "value", fun.aggregate = mean)
masterDataFrame <- as.data.frame(masterDataFrame)
masterDataFrame$HR_day_1 <- hr_by_rat$day_1
masterDataFrame$HR_day_2 <- hr_by_rat$day_2
masterDataFrame$meanHR <- rowMeans(masterDataFrame[5:6])
masterDataFrame$rmssd_day_1 <- rmssd_by_rat$day_1
masterDataFrame$rmssd_day_2 <- rmssd_by_rat$day_2
masterDataFrame$meanRMSSD <- rowMeans(masterDataFrame[7:8])
deltaValue <- matrix(data=NA,nrow=length(ratList),ncol = 5)
colnames(deltaValue)<-c("ratID","DE_140","DE_141","CA_140","CA_141")
i=1
for(rat in ratList){
subset <- subset(FULLfinalSummaryW, ratID == rat)
DE_140 <- subset[1,5]
DE_141  <- subset[2,5]
CA_140 <- subset[1,4]
CA_141 <- subset[2,4]
deltaValue[i,]<-c(rat,DE_140,DE_141,CA_140,CA_141)
i=i+1
}
deltaValue <- data.frame(deltaValue)
masterDataFrame <- merge(masterDataFrame,deltaValue,by="ratID")
masterDataFrame$deltaDE <- masterDataFrame$DE_141 - masterDataFrame$DE_140
masterDataFrame$deltaCA <- masterDataFrame$CA_141 - masterDataFrame$CA_140
masterDataFrame$delta_diff <- masterDataFrame$deltaDE - masterDataFrame$deltaCA
